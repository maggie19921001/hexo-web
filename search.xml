<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Hello World</title>
    <url>/hexo-web/2024/05/29/hello-world/</url>
    <content><![CDATA[<p>Welcome to <a class="link"   href="https://hexo.io/" >Hexo <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>! This is your very first post. Check <a class="link"   href="https://hexo.io/docs/" >documentation <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> for more info. If you get any problems when using Hexo, you can find the answer in <a class="link"   href="https://hexo.io/docs/troubleshooting.html" >troubleshooting <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> or you can ask me on <a class="link"   href="https://github.com/hexojs/hexo/issues" >GitHub <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure></div>

<p>More info: <a class="link"   href="https://hexo.io/docs/writing.html" >Writing <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure></div>

<p>More info: <a class="link"   href="https://hexo.io/docs/server.html" >Server <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure></div>

<p>More info: <a class="link"   href="https://hexo.io/docs/generating.html" >Generating <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure></div>

<p>More info: <a class="link"   href="https://hexo.io/docs/one-command-deployment.html" >Deployment <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
]]></content>
  </entry>
  <entry>
    <title>修改hexo主題</title>
    <url>/hexo-web/2024/05/30/%E9%80%99%E6%98%AF%E7%AC%AC%E4%BA%8C%E7%AF%87%E6%96%87%E7%AB%A0/</url>
    <content><![CDATA[<h2 id="主題修改"><a href="#主題修改" class="headerlink" title="主題修改"></a>主題修改</h2><ul>
<li>安裝theme樣板套件（點進主題後，install文字 copy and paste and run）</li>
<li>再到主題資料夾內的 config.yml 修改細節</li>
</ul>
]]></content>
      <tags>
        <tag>hexo</tag>
        <tag>新手</tag>
      </tags>
  </entry>
  <entry>
    <title>hexo部落格</title>
    <url>/hexo-web/2024/05/30/%E9%80%99%E6%98%AF%E7%AC%AC%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0/</url>
    <content><![CDATA[<h2 id="標題來了"><a href="#標題來了" class="headerlink" title="標題來了"></a>標題來了</h2><blockquote>
<p>學習hexo快速建立部落格<br>mac 輸入終端機時要使用 sudo npm 開頭</p>
</blockquote>
]]></content>
      <tags>
        <tag>hexo</tag>
        <tag>新手</tag>
      </tags>
  </entry>
  <entry>
    <title>API 關鍵字搜尋＋搜尋結果換頁</title>
    <url>/hexo-web/2024/08/07/API-%E9%97%9C%E9%8D%B5%E5%AD%97%E6%90%9C%E5%B0%8B%EF%BC%8B%E6%90%9C%E5%B0%8B%E7%B5%90%E6%9E%9C%E6%8F%9B%E9%A0%81/</url>
    <content><![CDATA[<p>使用TDX API關鍵字搜尋，並依照分類執行換頁顯示結果</p>
<ol>
<li>監聽搜尋按鈕並關閉預設提交機制</li>
<li>先判斷下拉選單的分類為何，再抓取資料</li>
<li>網址列中filter代入使用者輸入文字(須先觀察網址列規則)</li>
<li><code>success</code>中將搜尋結果存儲在localStorage，並跳轉至結果頁面</li>
</ol>
<h2 id="搜尋頁"><a href="#搜尋頁" class="headerlink" title="搜尋頁"></a>搜尋頁</h2><div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">GetApiResponse</span>(<span class="params"></span>)&#123;    </span><br><span class="line">    <span class="keyword">let</span> accesstokenStr = $(<span class="string">&quot;#accesstoken&quot;</span>).<span class="title function_">text</span>();    </span><br><span class="line">    <span class="keyword">let</span> accesstoken = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(accesstokenStr); </span><br><span class="line">    <span class="keyword">const</span> searchTxt = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#search-txt&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> searchBtn = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#search-btn&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> chooseType = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.choose&#x27;</span>);</span><br><span class="line">    </span><br><span class="line">    searchBtn.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>,<span class="keyword">function</span>(<span class="params">e</span>)&#123;</span><br><span class="line">        e.<span class="title function_">preventDefault</span>(); <span class="comment">// 阻止表單提交</span></span><br><span class="line">        <span class="keyword">const</span> keyWord = searchTxt.<span class="property">value</span>;</span><br><span class="line">        <span class="keyword">if</span>(accesstoken !=<span class="literal">undefined</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(chooseType.<span class="property">value</span>==<span class="string">&#x27;scene&#x27;</span>)&#123;</span><br><span class="line">                $.<span class="title function_">ajax</span>(&#123;</span><br><span class="line">                    <span class="attr">type</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">                    <span class="attr">url</span>: <span class="string">`https://tdx.transportdata.tw/api/basic/v2/Tourism/ScenicSpot?%24filter=contains%28ScenicSpotName%2C%27<span class="subst">$&#123;keyWord&#125;</span>%27%29&amp;%24top=20&amp;%24format=JSON`</span>,             </span><br><span class="line">                    <span class="attr">headers</span>: &#123;</span><br><span class="line">                        <span class="string">&quot;authorization&quot;</span>: <span class="string">&quot;Bearer &quot;</span> + accesstoken.<span class="property">access_token</span>,</span><br><span class="line">                      &#125;,            </span><br><span class="line">                    <span class="attr">async</span>: <span class="literal">false</span>,</span><br><span class="line"></span><br><span class="line">                    <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">Data</span>) &#123;            </span><br><span class="line">                        <span class="comment">// 將搜尋結果存儲在localStorage</span></span><br><span class="line">                        <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;searchResults&#x27;</span>, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(<span class="title class_">Data</span>));</span><br><span class="line">                        <span class="comment">// 跳轉至結果頁面</span></span><br><span class="line">                        <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span> = <span class="string">&#x27;/html/search_results.html&#x27;</span>;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    <span class="attr">error</span>: <span class="keyword">function</span> (<span class="params">xhr, textStatus, thrownError</span>) &#123;</span><br><span class="line">                        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;errorStatus:&#x27;</span>,textStatus);</span><br><span class="line">                        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Error:&#x27;</span>,thrownError);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(chooseType.<span class="property">value</span>==<span class="string">&#x27;event&#x27;</span>)&#123;</span><br><span class="line">                $.<span class="title function_">ajax</span>(&#123;</span><br><span class="line">                    <span class="attr">type</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">                    <span class="attr">url</span>: <span class="string">`https://tdx.transportdata.tw/api/basic/v2/Tourism/Activity?%24filter=contains%28ActivityName%2C%27<span class="subst">$&#123;keyWord&#125;</span>%27%29&amp;%24top=20&amp;%24format=JSON`</span>,             </span><br><span class="line">                    <span class="attr">headers</span>: &#123;</span><br><span class="line">                        <span class="string">&quot;authorization&quot;</span>: <span class="string">&quot;Bearer &quot;</span> + accesstoken.<span class="property">access_token</span>,</span><br><span class="line">                      &#125;,            </span><br><span class="line">                    <span class="attr">async</span>: <span class="literal">false</span>,</span><br><span class="line">                    <span class="comment">//Data是陣列</span></span><br><span class="line">                    <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">Data</span>) &#123;</span><br><span class="line">                        <span class="comment">// $(&#x27;#apireponse&#x27;).text(JSON.stringify(Data));                </span></span><br><span class="line">                        <span class="comment">// 將搜尋結果存儲在localStorage</span></span><br><span class="line">                        <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;searchResults&#x27;</span>, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(<span class="title class_">Data</span>));</span><br><span class="line">                        <span class="comment">// 跳轉至結果頁面</span></span><br><span class="line">                        <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span> = <span class="string">&#x27;/html/search_results.html&#x27;</span>;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    <span class="attr">error</span>: <span class="keyword">function</span> (<span class="params">xhr, textStatus, thrownError</span>) &#123;</span><br><span class="line">                        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;errorStatus:&#x27;</span>,textStatus);</span><br><span class="line">                        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Error:&#x27;</span>,thrownError);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(chooseType.<span class="property">value</span>==<span class="string">&#x27;food&#x27;</span>)&#123;</span><br><span class="line">                $.<span class="title function_">ajax</span>(&#123;</span><br><span class="line">                    <span class="attr">type</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">                    <span class="attr">url</span>: <span class="string">`https://tdx.transportdata.tw/api/basic/v2/Tourism/Restaurant?%24filter=contains%28RestaurantName%2C%27<span class="subst">$&#123;keyWord&#125;</span>%27%29&amp;%24top=20&amp;%24format=JSON`</span>,             </span><br><span class="line">                    <span class="attr">headers</span>: &#123;</span><br><span class="line">                        <span class="string">&quot;authorization&quot;</span>: <span class="string">&quot;Bearer &quot;</span> + accesstoken.<span class="property">access_token</span>,</span><br><span class="line">                      &#125;,            </span><br><span class="line">                    <span class="attr">async</span>: <span class="literal">false</span>,</span><br><span class="line">                    </span><br><span class="line">                    <span class="comment">//Data是陣列</span></span><br><span class="line">                    <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">Data</span>) &#123;</span><br><span class="line">                        <span class="comment">// $(&#x27;#apireponse&#x27;).text(JSON.stringify(Data));                </span></span><br><span class="line">                        <span class="comment">// 將搜尋結果存儲在localStorage</span></span><br><span class="line">                        <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;searchResults&#x27;</span>, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(<span class="title class_">Data</span>));</span><br><span class="line">                        <span class="comment">// 跳轉至結果頁面</span></span><br><span class="line">                        <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span> = <span class="string">&#x27;/html/search_results.html&#x27;</span>;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    <span class="attr">error</span>: <span class="keyword">function</span> (<span class="params">xhr, textStatus, thrownError</span>) &#123;</span><br><span class="line">                        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;errorStatus:&#x27;</span>,textStatus);</span><br><span class="line">                        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Error:&#x27;</span>,thrownError);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<ol start="5">
<li>從localStorage中獲取搜尋結果</li>
<li>設定組成畫面內容function<code>displayResults</code>(分三個分類的內容，個別帶入圖片及內容)</li>
<li>加入監聽結果</li>
</ol>
<h2 id="結果頁"><a href="#結果頁" class="headerlink" title="結果頁"></a>結果頁</h2><div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;DOMContentLoaded&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 從localStorage中獲取搜尋結果</span></span><br><span class="line">    <span class="keyword">const</span> results = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&#x27;searchResults&#x27;</span>));</span><br><span class="line">    <span class="title function_">displayResults</span>(results);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">displayResults</span>(<span class="params">results</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> resultsContainer = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.result-main&#x27;</span>);</span><br><span class="line">    <span class="keyword">let</span> str =<span class="string">&quot;&quot;</span>;</span><br><span class="line">    </span><br><span class="line">    results.<span class="title function_">forEach</span>(<span class="function"><span class="params">result</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> address = result.<span class="property">Address</span>.<span class="title function_">substring</span>(<span class="number">0</span>,<span class="number">3</span>);</span><br><span class="line">        <span class="keyword">if</span>(result.<span class="property">ScenicSpotName</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(result.<span class="property">Picture</span> &amp;&amp; result.<span class="property">Picture</span>.<span class="property">PictureUrl1</span>)&#123;</span><br><span class="line">                str+=<span class="string">`&lt;div class=&quot;spot-box&quot;&gt;</span></span><br><span class="line"><span class="string">                    &lt;div class=&quot;spot-pic&quot; style=&quot;background-image: url(<span class="subst">$&#123;result.Picture.PictureUrl1&#125;</span>); aria-label=&quot;<span class="subst">$&#123;result.PictureDescription1&#125;</span>&quot;&quot;&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">                    &lt;p class=&quot;spot-name fc-pri fw-7&quot;&gt;<span class="subst">$&#123;result.ScenicSpotName&#125;</span>&lt;/p&gt;</span></span><br><span class="line"><span class="string">                    &lt;div class=&quot;event-location dfaic&quot;&gt;</span></span><br><span class="line"><span class="string">                    &lt;img src=&quot;/images/Icon/spot16.png&quot; alt=&quot;&quot;&gt;</span></span><br><span class="line"><span class="string">                    &lt;span class=&quot;place fc-sub&quot;&gt;<span class="subst">$&#123;address&#125;</span>&lt;/span&gt;</span></span><br><span class="line"><span class="string">                    &lt;/div&gt;</span></span><br><span class="line"><span class="string">                &lt;/div&gt;`</span></span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                str+=<span class="string">`&lt;div class=&quot;spot-box&quot;&gt;</span></span><br><span class="line"><span class="string">                    &lt;div class=&quot;spot-pic&quot; style=&quot;background-image: url(/images/Images/Rectangle\ 85.png);&quot; aria-label=&quot;無附圖&quot;&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">                    &lt;p class=&quot;spot-name fc-pri fw-7&quot;&gt;<span class="subst">$&#123;result.ScenicSpotName&#125;</span>&lt;/p&gt;</span></span><br><span class="line"><span class="string">                    &lt;div class=&quot;event-location dfaic&quot;&gt;</span></span><br><span class="line"><span class="string">                    &lt;img src=&quot;/images/Icon/spot16.png&quot; alt=&quot;&quot;&gt;</span></span><br><span class="line"><span class="string">                    &lt;span class=&quot;place fc-sub&quot;&gt;<span class="subst">$&#123;result.City&#125;</span>&lt;/span&gt;</span></span><br><span class="line"><span class="string">                    &lt;/div&gt;</span></span><br><span class="line"><span class="string">                &lt;/div&gt;`</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(result.<span class="property">ActivityName</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(result.<span class="property">Picture</span> &amp;&amp; result.<span class="property">Picture</span>.<span class="property">PictureUrl1</span>)&#123;</span><br><span class="line">                str+=<span class="string">`&lt;div class=&quot;spot-box&quot;&gt;</span></span><br><span class="line"><span class="string">                    &lt;div class=&quot;spot-pic&quot; style=&quot;background-image: url(<span class="subst">$&#123;result.Picture.PictureUrl1&#125;</span>); aria-label=&quot;<span class="subst">$&#123;result.PictureDescription1&#125;</span>&quot;&quot;&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">                    &lt;p class=&quot;spot-name fc-pri fw-7&quot;&gt;<span class="subst">$&#123;result.ActivityName&#125;</span>&lt;/p&gt;</span></span><br><span class="line"><span class="string">                    &lt;div class=&quot;event-location dfaic&quot;&gt;</span></span><br><span class="line"><span class="string">                    &lt;img src=&quot;/images/Icon/spot16.png&quot; alt=&quot;&quot;&gt;</span></span><br><span class="line"><span class="string">                    &lt;span class=&quot;place fc-sub&quot;&gt;<span class="subst">$&#123;result.City&#125;</span>&lt;/span&gt;</span></span><br><span class="line"><span class="string">                    &lt;/div&gt;</span></span><br><span class="line"><span class="string">                &lt;/div&gt;`</span></span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                str+=<span class="string">`&lt;div class=&quot;spot-box&quot;&gt;</span></span><br><span class="line"><span class="string">                    &lt;div class=&quot;spot-pic&quot; style=&quot;background-image: url(/images/Images/Rectangle\ 85.png);&quot; aria-label=&quot;無附圖&quot;&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">                    &lt;p class=&quot;spot-name fc-pri fw-7&quot;&gt;<span class="subst">$&#123;result.ActivityName&#125;</span>&lt;/p&gt;</span></span><br><span class="line"><span class="string">                    &lt;div class=&quot;event-location dfaic&quot;&gt;</span></span><br><span class="line"><span class="string">                    &lt;img src=&quot;/images/Icon/spot16.png&quot; alt=&quot;&quot;&gt;</span></span><br><span class="line"><span class="string">                    &lt;span class=&quot;place fc-sub&quot;&gt;<span class="subst">$&#123;result.City&#125;</span>&lt;/span&gt;</span></span><br><span class="line"><span class="string">                    &lt;/div&gt;</span></span><br><span class="line"><span class="string">                &lt;/div&gt;`</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(result.<span class="property">Picture</span> &amp;&amp; result.<span class="property">Picture</span>.<span class="property">PictureUrl1</span>)&#123;</span><br><span class="line">                str+=<span class="string">`&lt;div class=&quot;spot-box&quot;&gt;</span></span><br><span class="line"><span class="string">                    &lt;div class=&quot;spot-pic&quot; style=&quot;background-image: url(<span class="subst">$&#123;result.Picture.PictureUrl1&#125;</span>); aria-label=&quot;<span class="subst">$&#123;result.PictureDescription1&#125;</span>&quot;&quot;&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">                    &lt;p class=&quot;spot-name fc-pri fw-7&quot;&gt;<span class="subst">$&#123;result.RestaurantName&#125;</span>&lt;/p&gt;</span></span><br><span class="line"><span class="string">                    &lt;div class=&quot;event-location dfaic&quot;&gt;</span></span><br><span class="line"><span class="string">                    &lt;img src=&quot;/images/Icon/spot16.png&quot; alt=&quot;&quot;&gt;</span></span><br><span class="line"><span class="string">                    &lt;span class=&quot;place fc-sub&quot;&gt;<span class="subst">$&#123;result.City&#125;</span>&lt;/span&gt;</span></span><br><span class="line"><span class="string">                    &lt;/div&gt;</span></span><br><span class="line"><span class="string">                &lt;/div&gt;`</span></span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                str+=<span class="string">`&lt;div class=&quot;spot-box&quot;&gt;</span></span><br><span class="line"><span class="string">                    &lt;div class=&quot;spot-pic&quot; style=&quot;background-image: url(/images/Images/Rectangle\ 85.png);&quot; aria-label=&quot;無附圖&quot;&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">                    &lt;p class=&quot;spot-name fc-pri fw-7&quot;&gt;<span class="subst">$&#123;result.RestaurantName&#125;</span>&lt;/p&gt;</span></span><br><span class="line"><span class="string">                    &lt;div class=&quot;event-location dfaic&quot;&gt;</span></span><br><span class="line"><span class="string">                    &lt;img src=&quot;/images/Icon/spot16.png&quot; alt=&quot;&quot;&gt;</span></span><br><span class="line"><span class="string">                    &lt;span class=&quot;place fc-sub&quot;&gt;<span class="subst">$&#123;result.City&#125;</span>&lt;/span&gt;</span></span><br><span class="line"><span class="string">                    &lt;/div&gt;</span></span><br><span class="line"><span class="string">                &lt;/div&gt;`</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    resultsContainer.<span class="property">innerHTML</span> = str;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>]]></content>
      <tags>
        <tag>API</tag>
        <tag>JavaScript</tag>
      </tags>
  </entry>
  <entry>
    <title>TDX API 串接(2024)</title>
    <url>/hexo-web/2024/08/07/TDX-API-%E4%B8%B2%E6%8E%A5-2024/</url>
    <content><![CDATA[<p>初次使用<a class="link"   href="https://tdx.transportdata.tw/" >TDX <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>的API資料<br>網頁中有提供<a class="link"   href="https://github.com/tdxmotc/SampleCode" >範例程式碼 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br>在2024&#x2F;6&#x2F;1開始實施收費<br>無付費的基礎會員官網上是寫可存取5次&#x2F;分&#x2F;金鑰<br>但我怎麼試綁API就是失敗，只有未申請會員的上限20次 :smiling_face_with_tear:	<br>最基本的銅級會員每月最低200元，基本個人使用算是滿夠用的，費用從每月一號開始計算，不足一個月會自動扣除未開通天數的費用<br>總之我就先買來測試下</p>
<h2 id="初始設定"><a href="#初始設定" class="headerlink" title="初始設定"></a>初始設定</h2><p>官方Sample使用jQuery寫初始設定，要先在html中嵌入<code>jQuery CDN</code>再進行JS<br>也必須要在html中加入Sample中的<code>取得憑證資料及API資料</code><br>這裡如果沒有加入也是無法正常使用，我自己是加入後用CSS隱藏起來</p>
<div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>取得憑證資料:<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;accesstoken&quot;</span> <span class="attr">class</span>=<span class="string">&quot;align-text-bottom&quot;</span>&gt;</span>        </span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>api 資料:<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;apireponse&quot;</span> <span class="attr">class</span>=<span class="string">&quot;align-text-bottom&quot;</span>&gt;</span>        </span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://code.jquery.com/jquery-2.1.4.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;Sample.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line">$(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">GetAuthorizationHeader</span>();</span><br><span class="line">    <span class="title class_">GetApiResponse</span>();    </span><br><span class="line">    <span class="title function_">getPhoto</span>();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div>
<h2 id="取得授權"><a href="#取得授權" class="headerlink" title="取得授權"></a>取得授權</h2><p>申請完帳號後，會員中心的資料服務可以找到<code>API金鑰</code>填入</p>
<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><figcaption><span>+</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">GetAuthorizationHeader</span>(<span class="params"></span>) &#123;    </span><br><span class="line">    <span class="keyword">const</span> parameter = &#123;</span><br><span class="line">        <span class="attr">grant_type</span>:<span class="string">&quot;client_credentials&quot;</span>,</span><br><span class="line">        <span class="attr">client_id</span>: <span class="string">&quot;填入授權ID&quot;</span>,</span><br><span class="line">        <span class="attr">client_secret</span>: <span class="string">&quot;填入授權金鑰&quot;</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> auth_url = <span class="string">&quot;https://tdx.transportdata.tw/auth/realms/TDXConnect/protocol/openid-connect/token&quot;</span>;</span><br><span class="line">        </span><br><span class="line">    $.<span class="title function_">ajax</span>(&#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">        <span class="attr">url</span>: auth_url,</span><br><span class="line">        <span class="attr">headers</span>: &#123;</span><br><span class="line">                </span><br><span class="line">              &#125;,  </span><br><span class="line">        <span class="attr">crossDomain</span>:<span class="literal">true</span>,</span><br><span class="line">        <span class="attr">dataType</span>:<span class="string">&#x27;JSON&#x27;</span>,                </span><br><span class="line">        <span class="attr">data</span>: parameter,</span><br><span class="line">        <span class="attr">async</span>: <span class="literal">false</span>,       </span><br><span class="line">        <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">data</span>)&#123;            </span><br><span class="line">            $(<span class="string">&quot;#accesstoken&quot;</span>).<span class="title function_">text</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(data));                            </span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">error</span>: <span class="keyword">function</span> (<span class="params">xhr, textStatus, thrownError</span>) &#123; </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);          </span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<h3 id="抓取資料"><a href="#抓取資料" class="headerlink" title="抓取資料"></a>抓取資料</h3><p>填入API網址後<br>在<code>success</code>中取得Data陣列就可以使用了！</p>
<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><figcaption><span>+</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">GetApiResponse</span>(<span class="params"></span>)&#123;    </span><br><span class="line">    <span class="keyword">let</span> accesstokenStr = $(<span class="string">&quot;#accesstoken&quot;</span>).<span class="title function_">text</span>();    </span><br><span class="line">    <span class="keyword">let</span> accesstoken = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(accesstokenStr);    </span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(accesstoken !=<span class="literal">undefined</span>)&#123;</span><br><span class="line">        $.<span class="title function_">ajax</span>(&#123;</span><br><span class="line">            <span class="attr">type</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">            <span class="attr">url</span>: <span class="string">&#x27;https://tdx.transportdata.tw/api/basic/v2/Rail/TRA/LiveTrainDelay?$top=30&amp;$format=JSON&#x27;</span>,             </span><br><span class="line">            <span class="attr">headers</span>: &#123;</span><br><span class="line">                <span class="string">&quot;authorization&quot;</span>: <span class="string">&quot;Bearer &quot;</span> + accesstoken.<span class="property">access_token</span>,</span><br><span class="line">              &#125;,            </span><br><span class="line">            <span class="attr">async</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">Data</span>) &#123;</span><br><span class="line">                <span class="comment">// $(&#x27;#apireponse&#x27;).text(JSON.stringify(Data));                </span></span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Data&#x27;</span>, <span class="title class_">Data</span>);</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">error</span>: <span class="keyword">function</span> (<span class="params">xhr, textStatus, thrownError</span>) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;errorStatus:&#x27;</span>,textStatus);</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Error:&#x27;</span>,thrownError);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>:::info<br>    Note:<br>    如果要將 js 運行在伺服器，可在ajax-get-headers中額外加入 ‘Accept-Encoding’: ‘br,gzip’，要求壓縮以減少網路傳輸資料量<br>    (原先的Sample中有寫，但測試時會一直出現錯誤)<br>:::</p>
]]></content>
      <tags>
        <tag>API</tag>
        <tag>JavaScript</tag>
      </tags>
  </entry>
</search>
